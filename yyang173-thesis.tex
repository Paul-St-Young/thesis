\documentclass[draftthesis,fullpage]{uiucthesis}
\setcounter{tocdepth}{4}
\setcounter{secnumdepth}{4}

\usepackage{amsmath,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage{braket}
\usepackage{subfiles}
\usepackage{comment}
%\usepackage[backend=bibtex]{biblatex}
%\defbibheading{general}{\section{Reference}}


% allow one reference for each chapter
%\usepackage[sectionbib]{natbib}
%\usepackage{chapterbib}
%%\usepackage[sectionbib]{chapterbib}

% import figures from difference folders
\input{./papers/nonbo/pre}
\graphicspath{{./papers/bandgap/},{./papers/nonbo/},{./papers/licp/}}

\newcommand{\toprule}{\hline\hline}
\newcommand{\midrule}{\hline}
\newcommand{\bottomrule}{\hline\hline}
\newcommand{\bs}{\boldsymbol}
\newcommand{\tr}{\text{tr}}
\newcommand{\up}{\uparrow}
\newcommand{\dn}{\downarrow}
\newcommand{\ham}{\mathcal{H}}

\begin{document}

\title{Electron-ion Correlation and Finite-size Effects in\\
       Quantum Monte Carlo Simulations}
\author{Yubo ``Paul'' Yang}
\department{Physics}
\schools{B.S., Denison University, 2014}
\phdthesis
\advisor{David M. Ceperley}
\degreeyear{2020}
\committee{Assistant Professor Prof B. K. Clark, Chair\\Professor Prof D. M. Ceperley, Director of Research\\Professor Prof J. N. Eckstein\\Professor Prof T. L. Hughes}
%\maketitle

%\include{sections/frontmatter}
\tableofcontents
%\include{sections/lists}
\mainmatter

\chapter{Introduction}
\section{The Many-body Problem}
%\subsection{Hydrogen Atom}
%\subsection{H$_2$ Molecule}
\subsection{Born-Oppenheimer Approximation (BOA)}
\section{Beyond the BOA}
\section{Hydrogen under Pressure}
\subsection{Solid phases and the Wigner-Huntington transition}
\subsection{Liquid phases and the liquid-liquid transition}
\subsection{The melting transition and critical point}
\section{Lithium Compton Profile}
\section{Insulator Band Gap}
\section{Outline}

\chapter{Methods}
\section{Mean-field Theory}
\subsection{Hartree-Fock (HF)}

\newcommand{\hcore}{H^{\text{core}}_{\mu\nu}}

\subsubsection{Minimum-basis H$_2$}

Instead of starting with the tedious derivation of the Fock operator and its iterative numerical solver, I will first show a concrete application of restricted Hartree-Fock (RHF) to minimum-basis hydrogen molecule (H$_2$). %The minimum basis consists of two 1s functions, one centered at each nucleus $\{\phi_\mu\}$, $\mu=1,\dots,K$, where $K=2$.
On p. 140 of A. Szabo and N. S. Ostlund, the restricted Fock operator in any basis $\{\phi_\mu\}$ is written as
\begin{align}
F_{\mu\nu} = \hcore + \sum\limits_{a=1}^{N/2} 2(\mu\nu|aa) - (\mu a|a\nu),
\end{align} % (3.148)
where $a$ labels molecular orbitals, which are eigenstates of the Fock operator. $\hcore$ is the one-electron part of the Hamiltonian expressed in the given basis % (3.149)
\begin{align} \label{eq:hf-hcore}
\hcore = \int d\bs{r}_1 \phi_\mu^*(\bs{r}_1)\left(
-\frac{1}{2}\nabla_1^2-\sum\limits_A \dfrac{Z_A}{\vert\bs{r}_1-\bs{R}_A\vert}
\right)  \phi_\nu(\bs{r}_1).
\end{align}
The two-electron integral notation $(\mu\nu|\lambda\sigma)$ is defined by eq.~(3.155) in Szabo
\begin{align} \label{eq:hf-eri}
(\mu\nu|\lambda\sigma) = \iint d\bs{r}_1 d\bs{r}_2 \phi_\mu^*(\bs{r}_1)\phi_{\nu}(\bs{r}_1)
\frac{1}{\vert\bs{r}_1-\bs{r}_2\vert}
\phi_\lambda^*(\bs{r}_2)\phi_\sigma(\bs{r}_2).
\end{align}
We immediately note that the Fock operator is a peculiar one-electron operator that depends on its own eigenstates. A self-consistent solution to $F_{\mu\nu}$ will involve guessing, checking and reiterating.

Suppose each molecular orbital $a$ is written as a linear combination of the basis functions
\begin{align}
\psi_a = \sum\limits_{\mu=1}^K C_{\mu a} \phi_\mu,
\end{align}
then the Fock operator can be written as
\begin{align}
F_{\mu\nu} = \hcore + \sum\limits_{\lambda\sigma} P_{\lambda\sigma} \left[
(\mu\nu|\sigma\lambda) - \frac{1}{2}(\mu\lambda|\sigma\nu)
\right],
\end{align} % (3.154)
where $P_{\lambda\sigma}=2\sum_{a=1}^{N/2} C_{\lambda a}C_{\sigma a}^*$ is the density matrix, % (3.145)
and 

Conceptually, the simplest approach would be to use the ground-state wavefunctions of the two hydrogen atoms as the basis for the hydrogen molecule. We can guess the ground-state wavefunction of the hydrogen molecule. First, the spins of the two electrons anti-align, so they are distinguishable particles. Second, due to symmetries imposed by the two protons, the ground state must be equal superposition of the two basis functions. Third, the lowest-energy solution has no node. Therefore, the ground state of H$_2$ in the minimum basis is
\begin{align}
\psi_1 = \left[2(1+S_{12})\right]^{-1/2} \left(
\phi_1 + \phi_2
\right),
\end{align}
where $S_{12}=\braket{\phi_1|\phi_2}$. That is $C_{11}=C_{12}=\left[2(1+S_{12})\right]^{-1/2}$.
\begin{align}
P_{\lambda\sigma} = \left[2(1+S_{12})\right]^{-1/2}\left(\begin{array}{cc}
1 & 1 \\
1 & 1
\end{array}\right).
\end{align}
This guess was obtained as early as 1927 by V. W. Heitler and F. London. Unfortunately, the multi-center integrals eq.~(\ref{eq:hf-hcore}) and (\ref{eq:hf-eri}), needed to evaluate the total energy, are difficult to evaluate using Slater type orbitals (STOs) (see thesis of Micha≈Ç Lesiuk). Thus, Heitler-London used an upper bound to approximate the two-electron integral and obtain a bond length of 1.5 bohr and binding energy of 2.5 eV, noticeably different from the experimental values of 1.4 bohr and 4.5 eV.

In modern quantum chemistry, instead of directly approximating the integrals, we approximate each basis function as a sum of Gaussian functions. This reduces the multi-center integrals to single-center integrals, because a product of Gaussians centered on different atoms is also Gaussian but with a different center. The so-called STO-3g basis expresses a STO as a sum of 3 ``primitive Gaussians'' (see eq. (3.225) of Szabo). Using this basis, the bond length and binding energy become 1.35 bohr and 3.2 eV, which roughly halves discrepancy with experiment when compared to the Heitler-London values.

In Fig. , I show the STO-3g basis compared to the exact STO it approximates

\begin{comment}
\begin{align}
\chi_{nlm}(r, \theta, \phi;\zeta) \equiv \dfrac{(2\zeta)^{n+1/2}}{\sqrt{(2n)!}}
r^{n-1}e^{-\zeta r} Y_{lm}(\theta, \phi).
\end{align}
\begin{align}
g(r; \sigma) = \dfrac{1}{\sigma\sqrt{2\pi}} e^{-\dfrac{r^2}{2\sigma^2}}.
\end{align}
\end{comment}

\subsubsection{The Hartree-Fock equations}
The Hartree-Fock equations are a set of linear equations that couple spin orbitals in the determinant wavefunction. They can be obtained by minimizing the energy of the Slater determinant with the constraint that the spin orbitals within the determinant remain orthonormal. Using the method of Lagrangian multipliers, this constraint optimization problem can be converted to a set of linear equations. These linear equations take the form of an eigenvalue problem, thus it is more concise to define the one-body operator on the left hand side as the Fock operator. (see eq.~(3.49) in Szabo).

The Fock operator can be written as a sum of one-electron part (the term in the parenthesis in eq.~(\ref{eq:hf-hcore})) and an effective mean-field interaction
\begin{align}
f(\bs{r}) = h(\bs{r}) + v_{HF}[\{\psi_a\}](\bs{r}),
\end{align}
where the square brackets indicate that the mean-field interaction depends on the spin orbitals.


\subsection{Density Functional Theory (DFT)}


\section{Classical Monte Carlo}


\subsection{Markov Chain Monte Carlo (MCMC)}


\subsection{Sample the Boltzmann Distribution $e^{-\beta H}$}

\section{Quantum Monte Carlo}
\begin{table}[h]
\centering
\begin{tabular}{cccccc}
\toprule
     & Temperature & Classical & Quantum & Quantization & Sign Problem \\
\midrule
PIMC &     any     &   yes     &   yes   & first & $\braket{\sigma}\propto \exp\left[ -\beta N (F_f-F_b) \right]$ \\
DMC  &    zero     &    no     &   yes   & first & $\braket{\sigma}\propto \exp\left[ -\beta N (F_f-F_T) \right]$ \\
FP-DMC & zero & no & yes & first & no \\
VMC & low & no & yes & first & no \\
AFQMC & low & no & yes & second & ? \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Path Integral Monte Carlo (PIMC)}
Path integral Monte Carlo samples the thermal density matrix in particle positions space (first quantization), applicable to any temperature. Seamless transition from Classical to quantum regimes. Ergodicity problem in sampling closed paths. Sign problem for fermions.

\begin{equation}
\rho = e^{-\beta \ham}
\end{equation}

\begin{equation}
Z = \text{Tr} \left( \rho \right)
\end{equation}

\begin{equation}
\rho = \sum\limits_{i=0}^\infty \epsilon_i \ket{\Psi_i}\bra{\Psi_i} 
\end{equation}

\begin{equation}
\rho_F(\mathcal{P}\bs{R}, \bs{R}'; \beta) = \sum\limits_{\mathcal{P}} (-1)^{\mathcal{P}} \rho_D (\mathcal{P}\bs{R}, \bs{R}'; \beta)
\end{equation}

\begin{equation}
\dfrac{d\rho}{d\beta} = -\ham \rho
\end{equation}

\subsection{Diffusion Monte Carlo (DMC)}
Diffusion Monte Carlo (DMC) uses an open path to sample ground-state wavefunction. The simulation and be interpreted as imaginary time evolution a trial wavefunction to project out the ground state. No ergodicity problem thanks to importance sampling using a physical guiding function. Sign problem for fermions remain in exact transient-estimate implementation.

\subsection{Fixed-phase Diffusion Monte Carlo (FP-DMC)}
Fixed-phase diffusion Monte Carlo uses a trial wavefunction to modify the Hamiltonian to resist change in the phase of the sampled path. No sign problem, but result is exact only if the phase of the trial wavefunction coincides with that of the exact ground-state wavefunction.

\subsection{Variational Monte Carlo (VMC)}

%\subsection{Auxiliary field quantum Monte Carlo (AFQMC)}

\chapter{Slater-Jastrow wavefunction}
\section{Overview}

A Slater determinant is a many-body wavefunction ansatz for the ground state of a collection of fermions (of the same spin). It is essentially the anti-symmetrized version of a product wavefunction ansatz for distinguishable particles.
\begin{align}
\Psi = \frac{1}{\sqrt{N!}}\sum\limits_{\mathcal{P}} (-1)^{\mathcal{P}} \left( \prod\limits_{i=1}^N \phi_{\mathcal{P}_i}(\bs{r}_i) \right),\label{eq:det}
\end{align}
where $N$ is the number of fermions, $\bs{r}_1, \bs{r}_2, \dots, \bs{r}_N$ are their spatial coordinates. $\mathcal{P}$ is a permutation of the particle index $1, 2, \dots, N$. $\phi_1, \phi_2, \dots, \phi_N$ are a set of one-body wavefunctions (a.k.a. orbitals).

\section{Single-particle orbitals}
\subsection{cusp correction}
\section{Jastrow pair function}
\subsection{Gaskell Random Phase Approximation (RPA)}
% 2018-04-27 li-nofk-iso
The RPA Jastrow potential given by Gaskell~\cite{Gaskell1961, Ceperley1978, Holzmann2009, Holzmann2016} is
\begin{align}
2\rho u^{RPA}_k = \left[ S_0(k) \left( 1 + 2\rho S_0^2(k) \nu_k/\epsilon_k \right)^{-1/2} \right] ^{-1} - S_0(k)^{-1}, \label{eq:rpauk}
\end{align}
where the $\nu_k$ is the Coulomb potential in reciprocal space and $\epsilon_k$ is the energy-momentum dispersion relation. For non-relativistic electrons in 3D, $\nu_k=\frac{4\pi}{k^2}$ and $\epsilon_k=\frac{k^2}{2}$ using Hatree atomic units. $S_0(k)$ is the static structure factor of the free Fermi gas
\begin{align}
S_0(k) = \left\{\begin{array}{l}
\frac{3}{4}\left( \frac{k}{k_F} \right) - \frac{1}{16}\left(\frac{k}{k_F}\right)^3 ~~~, k<2k_F \\
1.0 ~~~~~~~~~~~~~~~~~~~~~~~~, k \geq 2k_F
\end{array}\right..
\end{align}

Assuming Gaussian statistics for $\rho_{\bs{k}}$, one can obtain a general relation between the Jastrow potential and the static structure factor~\cite{Holzmann2011} %~\cite{Gaskell1961, Holzmann2011, Holzmann2016} [Interacting Electrons (6.22)]
\begin{align}
2\rho u_{\bs{k}} = S^{-1}(\bs{k}) - S^{-1}_0(\bs{k}). \label{eq:uk-sk}
\end{align}
Therefore, the RPA structure factor can be read off of $u^{RPA}_k$ in eq.~(\ref{eq:rpauk}) via eq.~(\ref{eq:uk-sk})
\begin{align}
S^{RPA}(k) = S_0(k)\left( 1 + 2\rho S_0^2(k) \nu_k/\epsilon_k \right)^{-1/2}. \label{eq:rpask}
\end{align}

The static structure factor of the valence electrons in lithium is quite close to that in jellium. In Fig.~\ref{fig:rpask}, the DMC pure-estimator structure factor of b.c.c. lithium is compared with the RPA result eq.~(\ref{eq:rpask}). The agreement as $k\rightarrow0$ is quite good.

\begin{figure}[h]
%\includegraphics[scale=1.0]{figures/008b_rpask}
\caption{Static structure factor of b.c.c. lithium.\label{fig:rpask}}
\end{figure}

% 2018-04-24_gaskell-rpa_thesis
Given one-component 3D homogeneous electron gas, Gaskell RPA Jastrow reads~\cite{Holzmann2009}
\begin{align}
2\rho u(k) = -S_0^{-1}(k) + \left[ S_0^{-2}(k) + \left( \frac{2\rho \nu_k}{\epsilon_k} \right) \right] ^{1/2}, \label{eq:gaskell-rpa-uk}
\end{align}
where $\rho = (4\pi r_s^3/3)^{-1}$, $\nu_k = \frac{4\pi e^2}{k^2}$, $\epsilon_k=\frac{\hbar^2 k^2}{2m_e}$, and $S_0(k)$ is the non-interacting structure factor
\begin{align}
S_0(k) = \frac{3}{4} \left(\frac{k}{k_F}\right) - \frac{1}{16}\left(\frac{k}{k_F}\right)^3,\text{ for } k\in[0,2k_F]; 1.0 \text{ for } k > 2k_F.
\end{align}
$k_F=(3\pi^2\rho)=\left(\frac{9\pi}{4r_s^3}\right)^{1/3}$ is the Fermi k vector. In Hatree atomic units, eq.~(\ref{eq:gaskell-rpa-uk}) simplifies to
\begin{align}
2\rho u(k) = -S_0^{-1}(k) + \left[ S_0^{-2}(k) + \left( \frac{12}{r_s^3 k^4} \right) \right]^{1/2}. \label{eq:gaskell-uk-au}
\end{align}

% 2018-08-20_tc-rpa-jas_thesis
\include{sections/tc-rpa-jas}

% 2018-08-10_slater-det-pw_thesis
\include{sections/slater-det-pw}

\section{Momentum distribution and the Fermi surface}
\section{Structure factor and the dielectric function}
\section{Back flow transformation}
\section{Beyond Slater-Jastrow}

\chapter{Theory and Observation of Finite-size Effects}
\section{Overview}
\section{Periodic boundary condition (PBC)}
\section{Thermodynamic limit}
\subsection{Shell-filling effect}
\subsection{Electronic structure factor $S(k)$}
\subsection{Jastrow pair function $U(k)$}
\subsection{Electronic momentum distribution $n(k)$}
\section{Grand-canonical twist-averaged boundary condition (GC-TABC)}

\chapter{Benchmark of dynamic-ion QMC on small molecules}
This chapter is based on the following article(s):

\textit{I}. Yubo Yang, Ilkka Kyl\"anp\"a\"a, Norm Tubman, Jaron Krogel, Sharon Hammes-Schiffer, and David Ceperley, ``How large are nonadiabatic effects in atomic and diatomic systems?" J. Chem. Phys. \textbf{143}, 124308 (2015).

\textit{II}. Norm Tubman, Yubo Yang, Sharon Hammes-Schiffer, and David Ceperley, ``Interpolated wave functions for nonadiabatic simulations with the fixed-node quantum Monte Carlo method," ACS Symp. Ser. \textbf{1234}, pp. 47-61 (2016).

\include{papers/nonbo/nonbo}
\input{papers/nonbo/nonbo.bbl}

\chapter{Application of dynamic-ion QMC to solid hydrogen}

\chapter{Effect of ions on the electronic momentum distribution}
This chapter is based on the following article(s):

\textit{I}. Yubo Yang, Nozomu Hiraoka, Kazuhiro Matsuda, Markus Holzmann, and David Ceperley, "Quantum Monte Carlo Compton profiles of solid and liquid lithium," arXiv: 1912.12295

%\include{papers/licp/licp}
%\printbibliography{[heading=general]}
%\input{papers/licp/licp.bbl}

\chapter{Finite-size correction to the fundamental gap of insulators}
This chapter is based on the following article(s):

\textit{I}. Yubo Yang, Vitaly Gorelov, Carlo Pierleoni, Markus Holzmann, and David Ceperley, ``Electronic band gaps from quantum Monte Carlo methods," Phys. Rev. B \textbf{101}, 085115 (2020).

%\include{papers/bandgap/bandgap}

\chapter{Classical many-body potential from QMC forces}

\end{document}