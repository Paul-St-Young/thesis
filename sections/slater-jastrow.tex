\chapter{Slater-Jastrow wave function}

What have we learnt from studying wave functions?
Cusp condition, plasmon modes, back flow quasiparticle excitations

\section{Historic Overview}

In condensed matter, the development of many-body wave function took off in the study of homogeneous quantum liquids, e.g., liquid helium and the homogeneous electron gas, a.k.a. jellium. Most studies made use of the variational principle, which states that given a Hamiltonian $\ham$, any trial wave function will have an energy value no less than that of the true ground state $\braket{\Psi_T|\ham|\Psi_T}\ge\braket{\Psi_0|\ham|\Psi_0}$. This principle allowed the pioneers to make educated guesses, then check the quality of theses guess. Of course, the energy value is only one number. More are needed to truly quantify the accuracy of a wave function, but I digress.

As early as 1934, E. Wigner~\cite{Wigner1934} noted that by introducing a “hole” in the correlation function of opposite-spin elections, one can improve the Slater determinant and lower its energy value in the homogeneous electron gas. Although, this hint was not acted on until much later.
In 1940, A. Bijl~\cite{Bijl1940} found that the logarithm of the wave function of many-interacting particles is size extensive. This logarithm can be expressed as a perturbation expansion involving one- and two-electron terms and is convergent in the thermodynamic limit.
Unfortunately, this work went unnoticed for 30 years while others independently developed similar ideas. Expanding the logarithm of the wave function is a general idea that later became known as the Bijl-Dingle-Jastrow-Feenberg expansion~\cite{Carleo2017} for historical reasons, which I will now describe.

In 1949, R. B. Dingle~\cite{Dingle1949}, while estimating the zero-point energy of hard spheres, came up with a product of exponential functions as a variational wave function by considering symmetries and limits. In 1955, R. Jastrow~\cite{Jastrow1955} generalized the Dingle pair product wave function to indistinguishable particles with Bose and Fermi statistics. To generalize to fermions, he multiplied the pair product wave function by a Slater determinant to enforce antisymmetric permutation symmetry. Thus, the Slater-Jastrow wave function was born. While this thesis is mostly focused on the Slater-Jastrow wave function for electronic matter, the idea of separating particle-statistics from correlation effects is general for classical and quantum matter %eq.~(\ref{eq:wf-prod-jas})
\begin{align} \label{eq:wf-prod-jas}
\Psi = \left\{\begin{array}{ll}
I \exp(-U) & \text{distinguishabe} \\
P \exp(-U) & \text{bosons} \\
D \exp(-U) & \text{fermions}
\end{array}\right.,
\end{align}
where $I$, $P$, $D$ are identity, permanent, and determinant respectively. In fact, some important improvements to eq.~(\ref{eq:wf-prod-jas}) came from the study of bosons rather than fermions.

In 1956, R.P. Feynman and M. Cohen~\cite{Feynman1956} found it crucial to include the effect of back flow to accurately describe rotons in liquid helium. A roton is the quantum analog of a microscopic vortex ring. When an atom moves through the ring, it triggers a returning flow far from the ring, a.k.a. back flow. R.P. Feynman first estimated the energy-momentum curve of liquid helium using a vanilla permanent of plane wave orbitals in 1954, but found the roton energies severely over-estimated~\cite{Feynman1954}. It is only after the introduction of back flow into the trial wave function did the roton energy can be reduced to a reasonable value, in qualitative agreement with the phenomenological theory of Landau and experiment~\cite{Feynman1956}.
In 1961, F.Y. Wu and E. Feenberg~\cite{Wu1961} introduced a pair approximation to the Jastrow wave function, to be defined by eq.~(\ref{eq:wf-def-jas}) and (\ref{eq:wf-def-j2}), and related the Jastrow pair function to the pair correlation function of liquid helium
\begin{align}
u(r) = g(r) - \dfrac{1}{8\pi^3\rho}\int d\bs{k} e^{-i\bs{k}\cdot\bs{r}}
\dfrac{[S(k)-1]^2}{1+\xi[S(k)-1]},
\end{align}
where $\xi\approx0.97$ gave accurate results under the superposition approximation.
Direct relation between experimentally measurable correlation functions and the wave function is an important avenue to glean understanding from the many-body wave function. Wu and Feenberg also wrote down expectation values of kinetic and potential operators
\begin{align}
\braket{T} = \frac{1}{2}\dfrac{N\rho}{2}\dfrac{\hbar^2}{2m} \int d\bs{r} g'(\bs{r}) u'(\bs{r}), \\
\braket{V} = \frac{1}{2} N\rho\int d\bs{r} g(\bs{r}) v(\bs{r}),
\end{align}
for non-relativistic particles having mass $m$ and interacting via a pair potential $v(\bs{r})$. These relations will later prove useful for the study of finite-size effects using the wave function. Similar ideas arose in the study of fermions in the same year.

%The most prominent success of the Slater-Jastrow wave function is its application to the homogeneous electron gas.
In 1961, T. Gaskell~\cite{Gaskell1961} calculated the Jastrow pair function for homogeneous electron gas. He expressed the Jastrow pair function in collective coordinates and explicitly calculated the pair correlation function using the random phase approximation (RPA). By analytically minimizing the total energy in the long wavelength limit, he derived an accurate Jastrow pair function, having correct limits at long and short wavelengths.
This Gaskell RPA wave function is crucially important in the study of homogeneous electron gas and will be discussed in Sec.~\ref{sec:gaskell-rpa-jas} and extended in Sec.~\ref{sec:mc-rpa-jas}.
%In 1978, D. M. Ceperley~\cite{Ceperley1978} extended the Gaskell pair function to Wigner crystal.
Using the Gaskell RPA wave function as trial function, in 1980, D. M. Ceperley and B. J. Alder~\cite{Ceperley1980} solved the homogeneous electron gas problem in three spatial dimensions.

%In 1977, C. C. Chang and C. E. Campbell~\cite{Chang1977} added a three-body term to the Slater-Jastrow wave function and observed better agreement with experiment.

A common theme of these early successes is guessing and checking of correlation. One guesses that a many-body correlation is important, incorporates said correlation into the wave function, then checks if the energy value is lowered and/or correlation functions get closer to experiment. %This approach requires one to think long and hard about the physics of a particular problem, to have the mathematical prowess to connect observed correlation with a wave function form, and to be lucky enough to have some experimental data to compare with. This set of circumstances is less and less likely today, so instead, recent advances in many-body wave function have been driven by numerical optimization of general wave function forms with many parameters. Examples include orbital rotation in a single determinant, multi-determinant expansion, iterative back flow, and neural network.

\section{Definitions}

\subsection{Definition 1: Fourier Transform}
The Fourier transform of a 3D function in coordinate space is defined as
\begin{align}
f(\bs{k}) = \int d^3\bs{r} e^{i\bs{k}\cdot\bs{r}} f(\bs{r}). \label{eq:forward-ft}
\end{align}
The above Fourier transform convention eq.~(\ref{eq:forward-ft}) defines its inverse
\begin{align}
f(\bs{r}) = \int \frac{d^3\bs{k}}{(2\pi)^3} e^{-i\bs{k}\cdot\bs{r}} f(\bs{k}). \label{eq:inverse-ft}
\end{align}
The consistency of eq.~(\ref{eq:forward-ft}) and (\ref{eq:inverse-ft}) can be checked using the Coulomb potential $v(\bs{r})=\frac{1}{r}$ and $v(\bs{k})=\frac{4\pi}{k^2}$. 

In a finite cell of volume $\Omega$, momentum states are discretized. Each state takes up $\frac{(2\pi)^3}{\Omega}$ in reciprocal space. Therefore the inverse Fourier transform (\ref{eq:inverse-ft}) becomes
\begin{align}
f(\bs{r}) = \frac{1}{\Omega} \sum\limits_{\bs{k}} e^{-i\bs{k}\cdot\bs{r}} f_{\bs{k}}.
\end{align}

\subsection{Definition 2: Collective Coordinates}
The collective coordinates of $N$ particles of species $\alpha$ is the Fourier transform of the instantaneous number density
\begin{align}
\rho^\alpha(\bs{k}) = \int d^3\bs{r} e^{i\bs{k}\cdot\bs{r}} \rho^\alpha(\bs{r})
= \int d^3\bs{r} e^{i\bs{k}\cdot\bs{r}} \sum\limits_{j=1}^{N_\alpha} \delta(\bs{r}-\bs{r}^\alpha_j)=\sum\limits_{j=1}^{N_\alpha} e^{i\bs{k}\cdot\bs{r}_j^\alpha}. \label{eq:rhok}
\end{align}
The collective coordinates provide a basis for many-body functions in reciprocal space. Consider $N$ particles in a cell of volume $\Omega$ interacting via an isotropic pair potential $v(r)$. The potential energy
\begin{align}
V =& \sum\limits_{i<j} v(r_{ij}) = \frac{1}{2} \sum\limits_{i\neq j} v(r_{ij}) \nonumber \\
=& \frac{1}{2\Omega} \sum\limits_{\bs{k}}v_{\bs{k}} \sum\limits_{i\neq j}   e^{-i\bs{k}\cdot(\bs{r}_i-\bs{r}_j)} \nonumber \\
=& \frac{1}{2\Omega} \sum\limits_{\bs{k}}v_{\bs{k}} \left( \rho_{\bs{k}}\rho_{-\bs{k}}-N \right). \label{eq:pot-oc}
\end{align}
When generalized to multiple species, eq.~(\ref{eq:pot-oc}) becomes
\begin{align}
V =& \frac{1}{2}\sum\limits_{\alpha, \beta} \sum\limits_{i=1}^{N_\alpha} \sum\limits_{j=1}^{N_\beta, (j,\beta)\neq(i,\alpha)} v^{\alpha\beta}(\vert\bs{r}_i^\alpha - \bs{r}_j^\beta \vert) \nonumber \\
=& \frac{1}{2\Omega} \sum\limits_{\bs{k}}
v^{\alpha\beta}_{\bs{k}} \left( \rho^\beta_{\bs{k}\alpha\beta}\rho^\alpha_{-\bs{k}}-\delta_{\alpha\beta}N_\alpha \right). \label{eq:pot-mc}
\end{align}
For particles interacting via the Coulomb pair potential
\begin{align}
v^{\alpha\beta}(\bs{r}) = \frac{Q_\alpha Q_\beta}{r},
\end{align}
where $Q_\alpha$ and $Q_\beta$ are the charges of species $\alpha$ and $\beta$, respectively.

\subsection{Definition 3: Jastrow Pair Potential}
The general form of a Jastrow wavefunction containing two-body terms is
\begin{align} \label{eq:wf-def-jas}
\Psi = \exp\left(-U\right),
\end{align}
where
\begin{align} \label{eq:wf-def-j2}
U =& \frac{1}{2}\sum\limits_{\alpha, \beta} \sum\limits_{i=1}^{N_\alpha} \sum\limits_{j=1}^{N_\beta, (j,\beta)\neq(i,\alpha)} 
u^{\alpha\beta}(\vert\bs{r}_i^\alpha - \bs{r}_j^\beta \vert) \nonumber \\
=& \frac{1}{2\Omega} \sum\limits_{\bs{k}\alpha\beta}
u^{\alpha\beta}_{\bs{k}} \left( \rho^\beta_{\bs{k}}\rho^\alpha_{-\bs{k}}-\delta_{\alpha\beta}N_\alpha \right).
\end{align}
$u^{\alpha\beta}(\bs{r})$ is the \emph{Jastrow pair potential}. In the high temperature limit, $u^{\alpha\beta}(\bs{r})=\frac{v^{\alpha\beta}(\bs{r})}{2k_BT}$.

\subsection{Definition 4: Slater Determinant}
A Slater determinant is a many-body wavefunction ansatz for the ground state of a collection of fermions (of the same spin). It is essentially the anti-symmetrized version of a product wavefunction ansatz for distinguishable particles.
\begin{align}
\Psi = \frac{1}{\sqrt{N!}}\sum\limits_{\mathcal{P}} (-1)^{\mathcal{P}} \left( \prod\limits_{i=1}^N \phi_{\mathcal{P}_i}(\bs{r}_i) \right),\label{eq:det}
\end{align}
where $N$ is the number of fermions, $\bs{r}_1, \bs{r}_2, \dots, \bs{r}_N$ are their spatial coordinates. $\mathcal{P}$ is a permutation of the particle index $1, 2, \dots, N$. $\phi_1, \phi_2, \dots, \phi_N$ are a set of one-body wavefunctions (a.k.a. orbitals).

\section{Cusp Conditions}
Consider two non-relativistic distinguishable particles having masses $m_1$ and $m_2$ interacting via a pair potential $v(r)$. The Schr\"odinger equation in the center-of-mass coordinate is
\begin{align}
\left[-\lambda\nabla^2 + v(r)\right] \psi = E\psi,
\end{align}
where $\lambda=\frac{\hbar^2}{2\mu}$, and $\mu=(m_1^{-1}+m_2^{-1})^{-1}$. The ground-state wave function
\begin{align}
\psi = \exp(-u(r))
\end{align}
should have a stationary local energy
\begin{align} \label{eq:wf-cusp}
E_L \equiv \dfrac{\ham\psi}{\psi} = v(r) + \lambda\nabla^2u(r) - (\bs{\nabla}u(r))^2 \nonumber \\
= v(r) + \lambda (u''+\frac{(d-1)u'}{r}) - \lambda {u'}^2,
\end{align}
where $d$ is the number of spatial dimensions.
We see that the laplacian term in the kinetic energy has a divergent term at $r=0$.
This term can respond to the potential term and keep $E_L$ stationary, even if $v(r)$ as a divergence at $r=0$, e.g., the Coulomb potential. Suppose the two particles have charges $q_1$, $q_2$, and $v(r)=q_1q_2/r$, the condition for stationary $E_L$ requires
\begin{align}
\lim\limits_{r\rightarrow 0}\frac{1}{r} (q_1q_2+ \lambda (d-1) u')=0 \Rightarrow u'(0) = \dfrac{q_1q_2}{\lambda (d-1)}
\end{align}
For electron-electron interaction in Hartree atomic units $m_1=m_2=1$, so $\lambda=1$ and $u'(0)=\frac{1}{2}$ in 3D. This is the cusp condition for unlike-spin electron pair. For same-spin pair, the two particles are indistinguishable and the laplacian for each particle contributes a copy of the divergent term. Thus, $u'(0)=\frac{1}{4}$. For an electron-ion pair in the clamped-ion approximation ($m_2\rightarrow\infty$)
\begin{align} \label{eq:wf-ei-cusp}
u'(0) = -\dfrac{2Z}{d-1},
\end{align}
where $Z$ is the atomic number of the ion. Imposing the cusp conditions on a trial wave function greatly reduces the variance of the local energy and improves the efficiency of a QMC calculation. The electron-ion cusp eq.~(\ref{eq:wf-ei-cusp}) is the most important one to maintain, because the wave function amplitude around an ion is high and many samples from the MC algorithm will have some electron close to an ion. In contrast, one rarely samples a configuration with two electrons close together due to strong electron-electron repulsion. Thus, the effect of imposing the electron-electron cusp condition is less visible than its electron-ion counterpart.

\input{sections/gaskell-rpa}

% 2018-08-20_tc-rpa-jas_thesis
\input{sections/tc-rpa-jas}

% 2018-08-10_slater-det-pw_thesis
\input{sections/slater-det-pw}
%\section{Back flow transformation}
\section{Beyond Slater-Jastrow}